<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Catálogo de Produtos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
    h2 { margin-top: 40px; }
    .produto { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 8px; background: white; }
    .cores, .tamanhos { display: flex; gap: 5px; margin: 10px 0; }
    .cor, .tam {
      width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;
      border: 1px solid #ccc; border-radius: 4px; cursor: pointer;
    }
    .cor.selecionado, .tam.selecionado { border: 2px solid black; }
    .cor { text-indent: -9999px; }
    .cor.vermelho { background: red; }
    .cor.azul { background: blue; }
    .cor.verde { background: green; }
    .tam { background: #eee; }
    .btn { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    .btn:hover { background: #0056b3; }
    .lista { margin-top: 30px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    .resumo { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>

  <h1>Catálogo de Produtos</h1>

  <div class="produto" data-codigo="001" data-nome="Camiseta Básica" data-descricao="Camiseta 100% algodão">
    <h3>Camiseta Básica (001)</h3>
    <p>Camiseta 100% algodão</p>
    <div><strong>Cores:</strong></div>
    <div class="cores">
      <div class="cor vermelho" data-cor="Vermelho"></div>
      <div class="cor azul" data-cor="Azul"></div>
      <div class="cor verde" data-cor="Verde"></div>
    </div>
    <div><strong>Tamanhos:</strong></div>
    <div class="tamanhos">
      <div class="tam" data-tam="P" data-disponivel="3">P</div>
      <div class="tam" data-tam="M" data-disponivel="2">M</div>
      <div class="tam" data-tam="G" data-disponivel="4">G</div>
    </div>
    <div>
      <label>Quantidade: <input type="number" min="1" value="1" class="quantidade"></label>
      <button class="btn adicionar">Adicionar à Lista</button>
    </div>
  </div>

  <!-- Mais produtos podem ser duplicados com mesmo formato acima -->

  <div class="lista">
    <h2>Lista de Compras</h2>
    <table id="tabela-lista">
      <thead>
        <tr>
          <th>Código</th>
          <th>Produto</th>
          <th>Cor</th>
          <th>Tamanho</th>
          <th>Qtd</th>
          <th>Remover</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="resumo">Total de Itens: <span id="total-itens">0</span></div>
    <button class="btn" onclick="enviarWhatsApp()">Enviar por WhatsApp</button>
  </div>

  <script>
    let lista = [];

    document.querySelectorAll('.produto').forEach(produto => {
      let corSelecionada = null;
      let tamanhoSelecionado = null;

      const cores = produto.querySelectorAll('.cor');
      const tamanhos = produto.querySelectorAll('.tam');
      const btnAdicionar = produto.querySelector('.adicionar');
      const inputQtd = produto.querySelector('.quantidade');

      cores.forEach(cor => {
        cor.addEventListener('click', () => {
          cores.forEach(c => c.classList.remove('selecionado'));
          cor.classList.add('selecionado');
          corSelecionada = cor.dataset.cor;
        });
      });

      tamanhos.forEach(tam => {
        tam.addEventListener('click', () => {
          tamanhos.forEach(t => t.classList.remove('selecionado'));
          tam.classList.add('selecionado');
          tamanhoSelecionado = tam.dataset.tam;
        });
      });

      btnAdicionar.addEventListener('click', () => {
        const codigo = produto.dataset.codigo;
        const nome = produto.dataset.nome;
        const qtd = parseInt(inputQtd.value);

        if (!corSelecionada || !tamanhoSelecionado || !qtd || qtd < 1) {
          alert("Selecione cor, tamanho e quantidade válida.");
          return;
        }

        const tamEl = [...tamanhos].find(t => t.dataset.tam === tamanhoSelecionado);
        const estoque = parseInt(tamEl.dataset.disponivel);

        // Verifica se já tem esse item com mesma cor/tam na lista
        const existente = lista.find(item =>
          item.codigo === codigo && item.cor === corSelecionada && item.tamanho === tamanhoSelecionado
        );

        const totalAtual = existente ? existente.qtd + qtd : qtd;
        if (totalAtual > estoque) {
          alert(`Quantidade excede o disponível (${estoque} unidades).`);
          return;
        }

        if (existente) {
          existente.qtd += qtd;
        } else {
          lista.push({ codigo, nome, cor: corSelecionada, tamanho: tamanhoSelecionado, qtd });
        }

        atualizarTabela();
      });
    });

    function atualizarTabela() {
      const tbody = document.querySelector('#tabela-lista tbody');
      tbody.innerHTML = '';
      let total = 0;

      lista.forEach((item, index) => {
        total += item.qtd;
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${item.codigo}</td>
          <td>${item.nome}</td>
          <td>${item.cor}</td>
          <td>${item.tamanho}</td>
          <td>${item.qtd}</td>
          <td><button onclick="removerItem(${index})">Remover</button></td>
        `;
        tbody.appendChild(row);
      });

      document.getElementById('total-itens').textContent = total;
    }

    function removerItem(index) {
      lista.splice(index, 1);
      atualizarTabela();
    }

    function enviarWhatsApp() {
      if (lista.length === 0) {
        alert("Lista está vazia!");
        return;
      }

      let mensagem = "Pedido:\n";
      lista.forEach(item => {
        mensagem += `• ${item.nome} (${item.codigo}) - Cor: ${item.cor}, Tamanho: ${item.tamanho}, Qtd: ${item.qtd}\n`;
      });

      const total = lista.reduce((s, i) => s + i.qtd, 0);
      mensagem += `\nTotal de itens: ${total}`;
      const fone = "5511999999999"; // Substituir pelo número desejado
      const url = `https://wa.me/${fone}?text=${encodeURIComponent(mensagem)}`;
      window.open(url, '_blank');
    }
  </script>

</body>
</html>
